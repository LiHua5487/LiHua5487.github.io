---
date: 2025-05-26
tags:
  - AI
---
多智能体系统 
- 一个环境中交互的多个智能体组成的 计算系统
- 每个智能体都在尝试获得最大的收益
- 多个智能体可以合作也可以竞争

# 博弈论

## 基本概念

正则形式博弈：可用收益矩阵描述，行/列对应两个参与者的行为，矩阵元素代表相关参与者的收益

**占优策略**
- 强占优：无论对手做什么，你的选择总是比其他选择更好
- 弱占优：你的选择至少不会比其它选择差，某些情况下还更好

**均衡**：没有参与者动机改变自己的策略，即当其他人选择不变时，任意改变自己的选择都会降低收益

理性参与者：总是选择占优策略，避免占劣策略
**占优策略均衡**：所有参与者都存在并选择占优策略

**囚徒困境**：双方都选择了占优策略，但是结果并不是最优

|      | A 检举             | A 沉默             |
| ---- | ---------------- | ---------------- |
| B 检举 | $A = -5, B = -5$ | $A = -10, B = 0$ |
| B 沉默 | $A = 0, B = -10$ | $A = -1, B = -1$ |
对于A，在 B 检举的情况下， A 检举的收益比沉默更高，对于 B 沉默的情况也是如此，那 A 的占优策略就是检举，同理 B 的占优策略也是检举
但实际上，对于整体结果，最优的策略应该是都沉默
所以一些情况下，不能单纯的按照最优策略选择

**帕累托改善**
- 能在不损害他人利益的情况下，让一个参与者收益更高
- 如果一个结果不再能帕累托改善，那么这个策略组合是帕累托最优

对于上面的囚徒困境，都沉默就是帕累托最优

**纳什均衡**
- 如果其他人策略保持不变，任何一个人都无法通过单方面改变自己的策略来而获得更高的收益，这个策略组合就是纳什均衡
- 是博弈中的一个局部稳定点
- 一个博弈中可能包括多个纳什均衡点， 也可能一个也没有
- 占优策略均衡就是一种纳什均衡

对于上面的囚徒策略，都检举或都沉默就是纳什均衡点

在下面这种情况

|     | A 1              | A 2            |
| --- | ---------------- | -------------- |
| B 1 | $A = 10, B = 10$ | $A = 0, B = 0$ |
| B 2 | $A = 0, B = 0$   | $A = 1, B = 1$ |
不存在占优策略
帕累托最优：A1 B1 
纳什均衡：A1 B1，A2 B2

对于下面这个零和博弈

|     | A 1             | A 2             |
| --- | --------------- | --------------- |
| B 1 | $A = 1, B = -1$ | $A = -1, B = 1$ |
| B 2 | $A = -1, B = 1$ | $A = 1, B = -1$ |
不存在占优策略
帕累托最优：都是
不存在纳什均衡

**纳什定理**：任何有限博弈中，所有人都用混合策略，那至少存在一个纳什均衡

比如对上面的零和博弈，A B 都有 0.5 的概率选择 1 或 2 时，就是一个纳什均衡

那怎么计算得出纳什均衡点？

**短视最优响应**
- 从随机策略组合出发
- 如果某个参与者没有处于最优选择，则调整他的选择为最优选择
- 重复上述过程
- 类似于循环梯度下降，但可能不收敛

## 双人零和博弈的纳什均衡

两个人 $(O, E)$ 同时出1或2根手指，如果总数是奇数，则 $O$ 获胜，否则 $E$ 获胜，胜者获得等于手指数的奖励，败者得到相同数量的惩罚

|     | O 1             | O 2             |
| --- | --------------- | --------------- |
| E 1 | $O = -2, E = 2$ | $O = 3, E = -3$ |
| E 2 | $O = 3, E = -3$ | $O = -4, E = 4$ |

假设 $E$ 选择 1 的概率是 $p$，$O$ 选择 1 的概率是 $q$  
对于 $O$，在已知 $E$ 的策略参数 $p$ 的情况下，想让自己收益最大，对于零和博弈，就是让对方收益最小，使得 $E$ 收益最小的选择为  
$$\text{argmin}(2p - 3(1 - p), -3p + 4(1 - p))$$
- 左边对应 $O$ 选 1 ，右边是 $O$ 选 2
  
![[AI引论/AIimg/img7/image 1.png|251x211]]

当 $p < 7/12$ 时，选 1 让 $E$ 收益更低；当 $p > 7/12$ ，选 2 让 $E$ 收益更低
对于 $E$ ，$p$ 的选择应使上述式最大，有 $p = 7/12$，收益为 $-1/12$  
这种情况称为 $E$ 的**最好最差情况**
此时，$O$ 采用混合策略建模，即设 $O$ 选 1 概率为 q

对于 $E$，在已知 $O$ 的策略参数 $q$ 的情况下，使得 $E$ 收益最大的选择为  
$$\text{argmax}(2q - 3(1 - q), -3q + 4(1 - q))$$
对于 $O$ ，$q$ 的选择应使上述式最小，同样可有 $q = 7/12$，$E$ 的收益为 $-1/12$
这种情况称为 $E$ 的**最差最好情况**

得到的结果就是纳什均衡点， $p=7/12,q=7/12$ ，收益 $O = 1/12,E = -1/12$

考虑更一般的情况
假设 $E$ 选择 one 的概率是 $p$，$O$ 选择 one 的概率是 $q$  
记 $p = [p, 1 - p]^T, q = [q, 1 - q]^T$ 为一组混合策略，M 为收益矩阵

针对 $E$ ，可以定义其最好的最差情况和最差的最好情况  
$$
\begin{align}
V_{\text{maximin}} &= \max_p \min_q p^T M q \\
V_{\text{minimax}} &= \min_q \max_p p^T M q
\end{align}
$$
- 其中 $p^T M q$ 为形式上的记号，代表双方采用混合策略 p q 时，最终的收益
- 满足 $V_{\text{maximin}} \leq V_{\text{minimax}}$

**冯诺依曼定理**：对于任意双人零和博弈，记 $M$ 为收益矩阵，$p_1$ 为玩家 $1$ 的混合策略，$p_2$ 为玩家 $2$ 的混合策略，若记 
$$
\begin{align}
V_{\text{maximin}} = \max_{p_1} \min_{p_2} p_1^T M p_2 \tag{1}\\
V_{\text{minimax}} = \min_{p_2} \max_{p_1} p_1^T M p_2 \tag{2}
\end{align}
$$
则有：$V_{\text{maximin}} = V_{\text{minimax}}$ ，此时 $(1)$ 的解 $p_1^*$ 和 $(2)$ 的解 $p_2^*$ 构成纳什均衡

## 合作博弈

一个例子，某公司四个股东A B C D 各有 45% 25% 15% 15% 的股份，他们需要投票决定是否以及如何对今年公司的100万收益进行分红

要通过分配方案至少需要合计 51% 的股份；否则，则每个人的分红都是 0 

但是每个股东股份都没达到 51% ，也就是说不同股东要进行合作，一起提出一个分配方案

把所有股东记为 $N=\{A,B,C,D\}$
这些股东可以组成一些合作关系，形成一些小团体
这些小团体称为**联盟**，记为 $C \subseteq N$ 
$N$ 本身也是一个联盟，即所有参与者一起合作

**划分**：每个参加者必须且仅加入一个联盟，构成的组合
每种划分构成一个**联盟结构**
比如，$\{B,C,D\}$ 就是一种联盟，$(\{A\},\{B,C,D\})$ 就是一种联盟结构

**特征函数** $v(C)$ ：不同联盟对应的总收益，根据博弈背景事先确定
一个合作博弈问题就可以记作 $G=(N,v)$

最终结果表示为 $(CS, x)$ ，包括两部分
- $CS$ 为**联盟结构**
- $x$ 为**收益向量**，$x_i$ 为每个人的收益

合作博弈主要解决的问题：如何分配收益使得联盟内的每个人收益最大化  

我们想找到一个普适的好的分配方案，要达到以下要求：
- 稳定：每个成员的收益足够好，从而不会离开联盟 
- 公平：每个成员的收益反应了他们的贡献

其中稳定性要求：
1. 个体理性：每个人合作的收益不低于自己单独的收益
$$x_i \geq v(\{i\})$$
2. 团体理性：整个大联盟的所有收益都必须分配
$$\sum_{i=1}^n x_i = v(N)$$
3. 团体稳定性：合作产生了正面的效果，至少达到预期
$$\sum_{i\in C}x_i\geq v(C)$$

而对于公平性，先定义贡献
**边际贡献**：参与者 $i$ 加入联盟 $C$ ($i \notin C$) 带来的额外收益
$$
\text{mc}_i(C) = v(C \cup \{i\}) - v(C)
$$

- 直觉上，边际贡献更大的参与者应该获得更多收益分配
- 无效参与者 dummy ：对任何联盟都没贡献
$$\forall C \subseteq N - \{i\}, \text{mc}_i(C) = 0$$
- 对称参与者：两个人在任何联盟中贡献都一样
$$\forall C \subseteq N - \{i, j\}, \text{mc}_i(C) = \text{mc}_j(C)$$

**公平性公理**：设 $\phi_i(G)$ 是问题 $G = (N, v)$ 的一个分配方案，需满足：
1. 所有收益必须得到分配
$$
\sum_{i \in N} \phi_i(G) = v(N)
$$
2. 无贡献者不分配收益
$$
\phi_i(G) = 0, \forall i \in \text{dummy}
$$

3. 对称参与者应得到相同收益
$$
\phi_i(G) = \phi_j(G), \forall \text{ symmetric } (i, j)
$$
4. 分配方案是线性可加的：对两个独立的博弈问题 $G = (N, v), G' = (N, v')$，定义 $G'' = G + G' = (N, v + v')$，则  
$$
\phi_i(G + G') = \phi_i(G) + \phi_i(G'), \forall i \in N
$$

如果我们直接按照边际贡献分配，并不合理
由于边际贡献的计算方式，每个人的贡献会受到加入联盟的顺序的影响，只按某种顺序去分配，这在一些情况下是不公平的

所以我们要考察所有可能的顺序，对应边际贡献的平均值
这就是 **Shapley 值**
$$
\phi_i(G) = \sum_{C \subseteq N \setminus \{i\}} \frac{|C|!(n - |C| - 1)!}{n!} \text{mc}_i(C)
$$
- $\phi(G) = (\phi_1(G), \phi_2(G), ..., \phi_n(G))$ 为收益向量
- Shapley 值是满足公平性公理的唯一解
